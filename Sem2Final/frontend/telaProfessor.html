<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel do Professor - Sistema de Laborat√≥rios ETEC</title>

    <!-- Bootstrap CSS via CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        xintegrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <!-- Google Fonts (Roboto e Roboto Slab) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@400;700&family=Roboto:wght@400;500;700&display=swap"
        rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

    <!-- CSS Personalizado (agora inclui acessibilidade) -->
    <link rel="stylesheet" href="telaProfessor.css">
</head>

<body>

    <!-- VLibras Widget -->
    <div vw class="enabled">
        <div vw-access-button class="active"></div>
        <div vw-plugin-wrapper>
            <div class="vw-plugin-top-wrapper"></div>
        </div>
    </div>

    <!-- Cabe√ßalho (Estrutura do Admin) -->
    <header class="cabecalho-inicial p-3 d-flex flex-wrap justify-content-between align-items-center">
        <!-- Coluna da Esquerda: Logo -->
        <div class="container-logo d-flex align-items-center">
            <a id="logoLink" href="https://etecjuliodemesquita.cps.sp.gov.br/"
                title="Visitar site da ETEC J√∫lio de Mesquita" aria-label="Abrir site da ETEC J√∫lio de Mesquita">
                <img src="https://bkpsitecpsnew.blob.core.windows.net/uploadsitecps/sites/143/2024/04/etec_santo_andre.png"
                    alt="Etec J√∫lio de Mesquita" class="me-2">
            </a>
        </div>

        <!-- Coluna do Meio: Informa√ß√µes da ETEC -->
        <div class="etec-info flex-grow-1 text-center mx-3 my-2 my-md-0">
            <strong>ETEC J√∫lio de Mesquita</strong>
            <p class="mb-0">Sistema de Laborat√≥rios de Qu√≠mica</p>
        </div>

        <!-- Coluna da Direita: Usu√°rio e A√ß√µes -->
        <div class="container-usuario d-flex align-items-center flex-wrap justify-content-center justify-content-md-end">
            <!-- Acessibilidade Dropdown -->
            <div class="dropdown-acessibilidade me-2">
                <button class="botao-acessibilidade" id="accessibilityBtn">
                    Acessibilidade
                </button>
                <div class="dropdown-content" id="accessibilityDropdown">
                    <a href="#" id="toggle-dark-mode"><i class="bi bi-moon-stars-fill"></i>Modo Escuro</a>
                    <div class="divider"></div>
                    <span class="dropdown-header">Tamanho da Fonte</span>
                    <a href="#" id="increase-font"><i class="bi bi-zoom-in"></i>Aumentar Fonte (A+)</a>
                    <a href="#" id="decrease-font"><i class="bi bi-zoom-out"></i>Diminuir Fonte (A-)</a>
                    <div class="divider"></div>
                    <span class="dropdown-header">Daltonismo</span>
                    <a href="#" data-mode="normal">Padr√£o</a>
                    <a href="#" data-mode="protanopia">Protanopia</a>
                    <a href="#" data-mode="deuteranopia">Deuteranopia</a>
                    <a href="#" data-mode="tritanopia">Tritanopia</a>
                </div>
            </div>
            <!-- Info do Usu√°rio -->
            <div class="usuario-info me-3 text-md-end text-center">
                <strong id="nome-usuario">Jo√£o Silva</strong>
                <p class="mb-0" id="tipo-usuario">Professor</p>
            </div>
            <!-- Bot√£o Sair -->
            <button class="botao-sair" id="botaoSair">
                Sair
            </button>
        </div>
    </header>

    <!-- Barra de navega√ß√£o (Estrutura do Admin) -->
    <nav class="barra-navegacao-principal navbar navbar-expand-lg">
        <div class="container-fluid justify-content-center">
            <!-- Bot√£o "Sandu√≠che" para telas pequenas -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <!-- Links de navega√ß√£o -->
            <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
                <div class="navbar-nav">
                    <a href="#" class="nav-link active" data-target="dashboard">Dashboard</a>
                    <a href="#" class="nav-link" data-target="novo-agendamento">Novo Agendamento</a>
                    <a href="#" class="nav-link" data-target="meus-kits">Meus Kits</a>
                    <a href="#" class="nav-link" data-target="historico">Hist√≥rico</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Conte√∫do Principal (Estrutura do Admin) -->
    <main class="container py-4">

        <!-- SE√á√ÉO 1: DASHBOARD -->
        <section id="dashboard" class="conteudo-secao ativo">
            
            <!-- Cards de Resumo (Estilo Admin) -->
            <div class="row g-4 mb-4">
                <div class="col-lg-3 col-md-6 col-12">
                    <div class="info-card">
                        <i class="bi bi-calendar-check"></i>
                        <div>
                            <p>Pr√≥ximas Aulas</p>
                            <span id="card-proximas-aulas">0</span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 col-12">
                    <div class="info-card">
                        <i class="bi bi-check-lg"></i>
                        <div>
                            <p>Kits Preparados</p>
                            <span id="card-kits-preparados">0</span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 col-12">
                    <div class="info-card">
                        <i class="bi bi-hourglass-split"></i>
                        <div>
                            <p>Aguardando</p>
                            <span id="card-aguardando">0</span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 col-12">
                    <div class="info-card">
                        <i class="bi bi-box-seam"></i>
                        <div>
                            <p>Meus Kits</p>
                            <span id="card-meus-kits">0</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- A√ß√µes R√°pidas (Envolvido em Card) -->
            <div class="card mb-4">
                <div class="card-header">
                    <h2 class="h4 mb-0">A√ß√µes R√°pidas</h2>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <a href="#" class="card-acao-rapida bg-red" id="acao-novo-agendamento">
                                <div class="card-acao-rapida-icone"><span>üìÖ</span></div>
                                <div class="card-acao-rapida-texto">
                                    <span class="titulo">Novo Agendamento</span>
                                    <span class="subtitulo">Agendar uso do laborat√≥rio</span>
                                </div>
                            </a>
                        </div>
                        <div class="col-md-4">
                            <a href="#" class="card-acao-rapida bg-dark-blue" id="acao-criar-kit">
                                <div class="card-acao-rapida-icone"><span>üß™</span></div>
                                <div class="card-acao-rapida-texto">
                                    <span class="titulo">Criar Kit</span>
                                    <span class="subtitulo">Novo kit de materiais</span>
                                </div>
                            </a>
                        </div>
                        <div class="col-md-4">
                            <a href="#" class="card-acao-rapida bg-solid-green" id="acao-ultimo-agendamento">
                               <div class="card-acao-rapida-icone"><span>üïí</span></div>
                               <div class="card-acao-rapida-texto">
                                   <span class="titulo">√öltimo Agendamento</span>
                                   <span class="subtitulo">Ver detalhes do √∫ltimo agendamento</span>
                               </div>
                           </a>
                       </div>
                    </div>
                </div>
            </div>
            
            <!-- Pr√≥ximas Aulas (Envolvido em Card) -->
            <div class="card">
                <div class="card-header">
                     <h2 class="h4 mb-0">Pr√≥ximas Aulas Agendadas</h2>
                </div>
                <div class="card-body">
                    <!-- Lista de Aulas (layout de card nativo) -->
                    <div class="lista-aulas" id="lista-proximas-aulas">
                        <!-- Conte√∫do ser√° injetado pelo JS -->
                        <p class="text-center p-3">Carregando agendamentos...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- SE√á√ÉO 2: NOVO AGENDAMENTO -->
        <section id="novo-agendamento" class="conteudo-secao">
            <div class="card">
                <div class="card-header">
                    <h2 class="h4 mb-0">Novo Agendamento</h2>
                </div>
                <div class="card-body p-4"> <!-- Adicionado padding aqui -->
                    <form class="agendamento-form" id="formNovoAgendamento">
                        
                        <!-- REMOVIDO: Campos desnecess√°rios (disciplina, turma, num_alunos, titulo_aula) -->

                        <div class="row g-3">
                            <div class="col-md-5">
                                <label for="data" class="form-label">Data</label>
                                <input type="date" name="data" id="data" class="form-control" required>
                            </div>
                            <div class="col-md-3">
                                <label for="horario-inicio" class="form-label">Hor√°rio In√≠cio</label>
                                <!-- TODO: Popular hor√°rios dinamicamente? -->
                                <input type="time" name="horario-inicio" id="horario-inicio" class="form-control" required>
                            </div>
                            <div class="col-md-3">
                                <label for="horario-fim" class="form-label">Hor√°rio Fim</label>
                                <input type="time" name="horario-fim" id="horario-fim" class="form-control" required>
                            </div>
                        </div>

                        <fieldset class="mt-4">
                            <legend class="form-label fs-5">Laborat√≥rio</legend>
                            <div class="row g-3" id="lista-laboratorios-form">
                                <!-- Laborat√≥rios ser√£o injetados pelo JS -->
                                <p class="text-center">Carregando laborat√≥rios...</p>
                            </div>
                        </fieldset>

                        <fieldset class="mt-4">
                            <legend class="form-label fs-5">Kits de Materiais</legend>
                            <div class="form-check">
                                <input type="radio" name="kit" id="kit-existente" value="existente" class="form-check-input" checked>
                                <label for="kit-existente" class="form-check-label">Usar kit existente</label>
                            </div>
                            <!-- Select de kits existentes (aparece/desaparece) -->
                            <div id="container-select-kit">
                                <label for="select-kit-existente" class="form-label visually-hidden">Selecionar Kit</label>
                                <select id="select-kit-existente" class="form-select mt-2">
                                    <option value="">Carregando kits...</option>
                                </select>
                            </div>
                            
                            <div class="form-check mt-2">
                                <input type="radio" name="kit" id="kit-novo" value="novo" class="form-check-input" disabled>
                                <label for="kit-novo" class="form-check-label text-muted">(Em breve) Criar novo kit para esta aula</label>
                            </div>
                            <!-- Textarea de novo kit (aparece/desaparece) -->
                            <div id="container-novo-kit" style="display: none;">
                                <label for="textarea-novo-kit" class="form-label visually-hidden">Descri√ß√£o do Novo Kit</label>
                                <textarea id="textarea-novo-kit" rows="4" placeholder="Liste os materiais e quantidades. Ex:&#10;- 1 B√©quer 100ml&#10;- 1 Pipeta 25ml&#10;- 1 Frasco de Fenolftale√≠na" class="form-control mt-2"></textarea>
                            </div>
                        </fieldset>

                        <div class="mt-3">
                            <label for="observacoes" class="form-label">Observa√ß√µes (T√≠tulo/Descri√ß√£o da Aula)</label>
                            <textarea name="observacoes" id="observacoes" rows="4" placeholder="Ex: Aula de Titula√ß√£o √Åcido-Base" class="form-control"></textarea>
                        </div>

                        <div class="d-flex justify-content-end gap-2 mt-4 pt-3 border-top">
                            <button type="submit" class="btn btn-custom-confirmar">Confirmar Agendamento</button>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <!-- SE√á√ÉO 3: MEUS KITS -->
        <section id="meus-kits" class="conteudo-secao">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h2 class="h4 mb-0">Meus Kits de Materiais</h2>
                    <button class="btn btn-custom" id="abrirModalKitBtn"><i class="bi bi-plus-circle-fill me-2"></i>Novo Kit</button>

                </div>
                <div class="card-body">
                    <div class="row g-4" id="lista-meus-kits">
                        <!-- Kits ser√£o injetados pelo JS -->
                         <p class="text-center p-3">Carregando kits...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- SE√á√ÉO 4: HIST√ìRICO -->
        <section id="historico" class="conteudo-secao">
             <div class="card">
                <div class="card-header">
                    <h2 class="h4 mb-0">Hist√≥rico de Agendamentos</h2>
                </div>
                <div class="card-body">
                    <!-- REMOVIDO: Filtros (simplifica√ß√£o) -->
                    <!-- Tabela para responsividade -->
                    <div class="table-responsive">
                        <table class="table table-hover align-middle">
                            <thead>
                                <tr>
                                    <th>Experimento</th>
                                    <th>Laborat√≥rio</th>
                                    <th>Kit</th>
                                    <th>Data</th>
                                    <th class="text-center">Status</th>
                                </tr>
                            </thead>
                            <tbody id="lista-historico">
                                <!-- Hist√≥rico ser√° injetado pelo JS -->
                                <tr><td colspan="5" class="text-center">Carregando hist√≥rico...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
             </div>
        </section>

    </main>

    <!-- VLibras JS -->
    <script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
    <script>
        new window.VLibras.Widget('https://vlibras.gov.br/app');
    </script>
    
    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        xintegrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <!-- Scripts da Aplica√ß√£o -->
    <script src="apiService.js"></script>
    <script src="telaProfessor.js"></script>

    <!-- Modais (Estrutura do Admin) -->
    
    <!-- NOVO: Modal "√öltimo Agendamento" -->
    <div class="modal-container" id="modalUltimoAgendamento">
        <div class="modal-card">
            <header class="modal-header">
                <h5 class="modal-title">Detalhes do √öltimo Agendamento</h5>
                <button type="button" class="btn-close" id="fecharModalUltimoAgendamentoBtn"></button>
            </header>
            <div class="modal-body">
                <div class="detalhes-aula-grupo">
                    <span class="detalhes-label">T√≠tulo/Descri√ß√£o:</span>
                    <span class="detalhes-valor" id="ultimo-agendamento-titulo"></span>
                </div>
                <div class="row g-3 my-2">
                    <div class="col-md-6">
                        <span class="detalhes-label">Laborat√≥rio:</span>
                        <span class="detalhes-valor" id="ultimo-agendamento-lab"></span>
                    </div>
                    <div class="col-md-6">
                        <span class="detalhes-label">Data/Hor√°rio:</span>
                        <span class="detalhes-valor" id="ultimo-agendamento-data"></span>
                    </div>
                </div>
                <div class="detalhes-aula-grupo">
                    <span class="detalhes-label">Kit de Materiais:</span>
                    <span class="detalhes-valor" id="ultimo-agendamento-kit"></span>
                </div>
                <div class="detalhes-aula-grupo">
                    <span class="detalhes-label">Instru√ß√µes de Preparo/Observa√ß√µes:</span>
                    <span class="detalhes-valor" id="ultimo-agendamento-obs"></span>
                </div>
            </div>
            <footer class="modal-footer">
                <button type="button" class="btn btn-secondary" id="fecharModalUltimoAgendamentoBtn_footer">Fechar</button>
            </footer>
        </div>
    </div>


    <!-- Modal "Novo kit" -->
    <div class="modal-container" id="modalNovoKit">
        <div class="modal-card">
            <header class="modal-header">
                <h5 class="modal-title">Criar Novo Kit de Materiais</h5>
                <button type="button" class="btn-close" id="fecharModalKitBtn"></button>
            </header>
            <div class="modal-body">
                <form id="formNovoKit">
                    <div class="form-group mb-3">
                        <label for="kit-nome" class="form-label">Nome do Kit</label>
                        <input type="text" id="kit-nome" class="form-control" placeholder="Ex: Titula√ß√£o √Åcido-Base" required>
                    </div>
                    <div class="form-group">
                        <label for="kit-descricao" class="form-label">Itens e Descri√ß√£o</label>
                        <textarea id="kit-descricao" class="form-control" rows="6"
                            placeholder="Liste os materiais e quantidades. Ex:&#10;- 1 B√©quer 100ml&#10;- 1 Pipeta 25ml&#10;- 1 Frasco de Fenolftale√≠na" required></textarea>
                    </div>
                </form>
            </div>
            <footer class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelarModalKitBtn">Cancelar</button>
                <button type="submit" form="formNovoKit" class="btn btn-success">Salvar Kit</button>
            </footer>
        </div>
    </div>

    <!-- Modal "Ver Detalhes" (Aula) -->
    <div class="modal-container" id="modalVerDetalhes">
        <div class="modal-card">
            <header class="modal-header">
                <h5 class="modal-title" id="detalhe-titulo">Detalhes da Aula</h5>
                <button type="button" class="btn-close" id="fecharModalVerDetalhesBtn"></button>
            </header>
            <div class="modal-body">
                <div class="detalhes-aula-grupo">
                    <span class="detalhes-label">T√≠tulo/Descri√ß√£o:</span>
                    <span class="detalhes-valor" id="detalhe-titulo"></span>
                </div>
                <div class="detalhes-aula-grupo">
                    <span class="detalhes-label">Status:</span>
                    <span class="detalhes-valor" id="detalhe-status"></span>
                </div>
                <div class="row g-3 my-2">
                    <div class="col-md-6">
                        <span class="detalhes-label">Turma:</span>
                        <span class="detalhes-valor" id="detalhe-turma">N/A</span>
                    </div>
                    <div class="col-md-6">
                        <span class="detalhes-label">N¬∫ de Alunos:</span>
                        <span class="detalhes-valor" id="detalhe-alunos">N/A</span>
                    </div>
                    <div class="col-md-6">
                        <span class="detalhes-label">Laborat√≥rio:</span>
                        <span class="detalhes-valor" id="detalhe-lab"></span>
                    </div>
                     <div class="col-md-6">
                        <span class="detalhes-label">Data/Hor√°rio:</span>
                        <span class="detalhes-valor" id="detalhe-data"></span>
                    </div>
                </div>
                <div class="detalhes-aula-grupo">
                    <span class="detalhes-label">Kit de Materiais:</span>
                    <span class="detalhes-valor" id="detalhe-kit"></span>
                </div>
                 <div class="detalhes-aula-grupo">
                    <span class="detalhes-label">Observa√ß√µes:</span>
                    <span class="detalhes-valor" id="detalhe-obs"></span>
                </div>
            </div>
            <footer class="modal-footer">
                <button type="button" class="btn btn-secondary" id="fecharModalVerDetalhesBtn_footer">Fechar</button>
            </footer>
        </div>
    </div>

    <!-- Modal "Editar" (Aula) - (Simplificado/Desativado) -->
    <div class="modal-container" id="modalEditarAula">
        <div class="modal-card">
            <header class="modal-header">
                <h5 class="modal-title">Editar Agendamento</h5>
                <button type="button" class="btn-close" id="fecharModalEditarAulaBtn"></button>
            </header>
            <div class="modal-body">
                <p>Fun√ß√£o de edi√ß√£o em desenvolvimento. Por favor, cancele e crie um novo agendamento.</p>
            </div>
            <footer class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelarModalEditarAulaBtn">Fechar</button>
            </footer>
        </div>
    </div>

    <!-- Modal "Ver Kit" -->
    <div class="modal-container" id="modalVerKit">
         <div class="modal-card">
            <header class="modal-header">
                <h5 class="modal-title" id="detalhe-kit-titulo"></h5>
                <button type="button" class="btn-close" id="fecharModalVerKitBtn"></button>
            </header>
            <div class="modal-body">
                <div class="detalhes-aula-grupo mb-3">
                    <span class="detalhes-label">Itens e Descri√ß√£o:</span>
                    <!-- Usando pre para manter a formata√ß√£o da textarea -->
                    <pre class="detalhes-kit-itens-lista" id="detalhe-kit-itens"></pre>
                </div>
                <div class="detalhes-aula-grupo">
                    <span class="detalhes-label">Dados de Uso:</span>
                    <span class="detalhes-valor" id="detalhe-kit-uso">
                        Em desenvolvimento.
                    </span>
                </div>
            </div>
            <footer class="modal-footer">
                <button type="button" class="btn btn-secondary" id="fecharModalVerKitBtn_footer">Fechar</button>
            </footer>
        </div>
    </div>

    <!-- Modal "Editar Kit" -->
    <div class="modal-container" id="modalEditarKit">
        <div class="modal-card">
            <header class="modal-header">
                <h5 class="modal-title">Editar Kit de Materiais</h5>
                <button type="button" class="btn-close" id="fecharModalEditarKitBtn"></button>
            </header>
            <div class="modal-body">
                <form id="formEditarKit">
                    <input type="hidden" id="edit-kit-id"> <!-- Campo oculto para o ID -->
                    <div class="form-group mb-3">
                        <label for="edit-kit-nome" class="form-label">Nome do Kit</label>
                        <input type="text" id="edit-kit-nome" name="kit-nome" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-kit-descricao" class="form-label">Itens e Descri√ß√£o</label>
                        <textarea id="edit-kit-descricao" name="kit-descricao" class="form-control" rows="6" required></textarea>
                    </div>
                </form>
            </div>
            <footer class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelarModalEditarKitBtn">Cancelar</button>
                <button type="submit" form="formEditarKit" class="btn btn-success">Salvar Altera√ß√µes</button>
            </footer>
        </div>
    </div>

    <!-- ADICIONADO: Modal de Confirma√ß√£o de Sa√≠da -->
    <div class="modal-container" id="modalConfirmarSaida">
        <div class="modal-card">
            <div class="modal-header">
                <h5 class="modal-title">Confirmar Sa√≠da</h5>
                <button type="button" class="btn-close" id="fecharModalSaidaBtn"></button>
            </div>
            <div class="modal-body">
                <p>Voc√™ tem certeza que deseja sair do sistema?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelarSaidaBtn">Cancelar</button>
                <button type="button" class="btn btn-danger" id="confirmarSaidaBtn">Sair</button>
            </div>
        </div>
    </div>

    <!-- Toast/Alerta Global -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="globalToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <i class="bi bi-info-circle-fill me-2"></i>
                <strong class="me-auto" id="toastTitle">Notifica√ß√£o</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body" id="toastBody">
                Mensagem.
            </div>
        </div>
    </div>

</body>

</html>